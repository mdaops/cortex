---
apiVersion: source.toolkit.fluxcd.io/v1
kind: HelmRepository
metadata:
  name: feast
spec:
  interval: 1h
  url: https://feast-helm-charts.storage.googleapis.com
---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: feast-feature-server
spec:
  interval: 30m
  targetNamespace: feast-system
  install:
    createNamespace: true
    remediation:
      retries: 3
  upgrade:
    cleanupOnFail: true
    remediation:
      retries: 3
  kubeConfig:
    secretRef:
      name: cluster-kubeconfig
  chart:
    spec:
      chart: feast-feature-server
      version: "0.46.0"
      sourceRef:
        kind: HelmRepository
        name: feast
      interval: 12h
  values:
    replicaCount: 1
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        memory: 512Mi
    securityContext:
      runAsUser: 1000
      runAsGroup: 1000
      fsGroup: 1000
      seccompProfile:
        type: RuntimeDefault
    containerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: false
    feature_store_yaml_base64: "cHJvamVjdDogc3luYXBzZQpyZWdpc3RyeTogL3RtcC9yZWdpc3RyeS5kYgpwcm92aWRlcjogbG9jYWwKb25saW5lX3N0b3JlOgogIHR5cGU6IHNxbGl0ZQogIHBhdGg6IC90bXAvb25saW5lX3N0b3JlLmRiCmVudGl0eV9rZXlfc2VyaWFsaXphdGlvbl92ZXJzaW9uOiAyCg=="
